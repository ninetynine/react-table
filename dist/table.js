"use strict";require("core-js/modules/es.symbol"),require("core-js/modules/es.symbol.description"),require("core-js/modules/es.symbol.iterator"),require("core-js/modules/es.array.concat"),require("core-js/modules/es.array.filter"),require("core-js/modules/es.array.find-index"),require("core-js/modules/es.array.from"),require("core-js/modules/es.array.index-of"),require("core-js/modules/es.array.is-array"),require("core-js/modules/es.array.iterator"),require("core-js/modules/es.array.map"),require("core-js/modules/es.array.slice"),require("core-js/modules/es.array.splice"),require("core-js/modules/es.date.to-string"),require("core-js/modules/es.function.name"),require("core-js/modules/es.object.assign"),require("core-js/modules/es.object.keys"),require("core-js/modules/es.object.to-string"),require("core-js/modules/es.parse-int"),require("core-js/modules/es.regexp.constructor"),require("core-js/modules/es.regexp.exec"),require("core-js/modules/es.regexp.to-string"),require("core-js/modules/es.string.iterator"),require("core-js/modules/es.string.replace"),require("core-js/modules/web.dom-collections.iterator"),Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=void 0;var _react=_interopRequireDefault(require("react")),_reactUse=require("react-use"),_propTypes=_interopRequireDefault(require("prop-types")),_classnames=_interopRequireDefault(require("classnames")),_helpers=require("./helpers");function _interopRequireDefault(a){return a&&a.__esModule?a:{default:a}}function _extends(){return _extends=Object.assign||function(a){for(var b,c=1;c<arguments.length;c++)for(var d in b=arguments[c],b)Object.prototype.hasOwnProperty.call(b,d)&&(a[d]=b[d]);return a},_extends.apply(this,arguments)}function _slicedToArray(a,b){return _arrayWithHoles(a)||_iterableToArrayLimit(a,b)||_unsupportedIterableToArray(a,b)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(a,b){if(a){if("string"==typeof a)return _arrayLikeToArray(a,b);var c=Object.prototype.toString.call(a).slice(8,-1);return"Object"===c&&a.constructor&&(c=a.constructor.name),"Map"===c||"Set"===c?Array.from(c):"Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c)?_arrayLikeToArray(a,b):void 0}}function _arrayLikeToArray(a,b){(null==b||b>a.length)&&(b=a.length);for(var c=0,d=Array(b);c<b;c++)d[c]=a[c];return d}function _iterableToArrayLimit(a,b){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(a)){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!(b&&c.length===b));d=!0);}catch(a){e=!0,f=a}finally{try{d||null==h["return"]||h["return"]()}finally{if(e)throw f}}return c}}function _arrayWithHoles(a){if(Array.isArray(a))return a}function _objectWithoutProperties(a,b){if(null==a)return{};var c,d,e=_objectWithoutPropertiesLoose(a,b);if(Object.getOwnPropertySymbols){var f=Object.getOwnPropertySymbols(a);for(d=0;d<f.length;d++)c=f[d],!(0<=b.indexOf(c))&&Object.prototype.propertyIsEnumerable.call(a,c)&&(e[c]=a[c])}return e}function _objectWithoutPropertiesLoose(a,b){if(null==a)return{};var c,d,e={},f=Object.keys(a);for(d=0;d<f.length;d++)c=f[d],0<=b.indexOf(c)||(e[c]=a[c]);return e}var Table=function(a){var b=a.rows,c=a.rowRenderer,d=a.rowIdentifier,e=a.emptyRow,f=a.dataManipulator,g=a.fieldMap,h=a.fieldOrder,j=a.fieldsToExclude,k=a.fieldsToInclude,l=a.header,m=a.footer,n=a.pageLimit,o=a.pages,p=a.actions,q=a.rowIsChecked,r=a.masterIsChecked,s=a.onRowClick,t=a.onRowToggle,u=a.onPageLimitChange,v=a.onPageChange,w=a.onMasterToggle,x=a.className,y=_objectWithoutProperties(a,["rows","rowRenderer","rowIdentifier","emptyRow","dataManipulator","fieldMap","fieldOrder","fieldsToExclude","fieldsToInclude","header","footer","pageLimit","pages","actions","rowIsChecked","masterIsChecked","onRowClick","onRowToggle","onPageLimitChange","onPageChange","onMasterToggle","className"]),z=(0,_reactUse.useSetState)({fields:[]}),A=_slicedToArray(z,2),B=A[0],C=A[1],D=function(){if(!b.length)return[];for(var a,c=b[0],d=Object.keys(c),e=j.filter(function(a){return"string"!=typeof a}),f=j.filter(function(a){return"string"==typeof a}),g=k.filter(function(a){return"string"!=typeof a}),l=k.filter(function(a){return"string"==typeof a}),m=0;m<d.length;m++){if(a=d[m],f.length&&-1<f.indexOf(a)){d.splice(m,1,null);continue}if(e.length){for(var n=!1,o=0;o<e.length;o++)if(e[o].test(a)){d.splice(m,1,null),n=!0;break}if(n)continue}if(l.length&&0>l.indexOf(a)){d.splice(m,1,null);continue}if(g.length){for(var p=!1,q=0;q<g.length;q++)if(!g[q].test(a)){d.splice(m,1,null),p=!0;break}if(p)continue}}d=d.filter(function(a){return a});for(var s=[],t=function(a){var b=d[a],c=h.findIndex(function(a){return"string"==typeof a?a===b:a.test(b)});-1<c?s.splice(c,0,b):s.push(b)},u=0;u<d.length;u++)t(u);return s};return(0,_reactUse.useMount)(function(){C({fields:D()})}),(0,_reactUse.useUpdateEffect)(function(){C({fields:D()})},[b]),_react["default"].createElement("div",_extends({},y,{className:(0,_classnames["default"])([x,"react-dynamic-table"])}),_react["default"].createElement("table",null,l&&_react["default"].createElement("thead",null,_react["default"].createElement("tr",null,t!==_helpers.NOOP&&_react["default"].createElement("th",null,w!==_helpers.NOOP&&_react["default"].createElement("input",{type:"checkbox",checked:r(),onChange:w})),function $headers(){return B.fields.map(function(a){return g[a]?g[a]:a.replace(/([A-Z])([A-Z])/g,function(c,d,a){return"".concat(d," ").concat(a)}).toLowerCase().replace(/([ -_]|^)(.)/g,function(c,d,a){return"".concat(d?" ":""," ").concat(a.toUpperCase())})})}().map(function(a){return _react["default"].createElement("th",{key:a},a)}),p!==_helpers.NOOP&&_react["default"].createElement("th",null))),_react["default"].createElement("tbody",null,0===b.length&&e,0<b.length&&b.map(function(a){var b=d(a);return c({key:b,row:a,fields:B.fields,dataManipulator:f,isChecked:q(b),actions:p===_helpers.NOOP?void 0:p(a),onClick:s===_helpers.NOOP?void 0:function(a){return s(b,a)},onToggle:t===_helpers.NOOP?void 0:function(){return t(b)}})})),(m!==_helpers.NOOP||n!==_helpers.NOOP)&&_react["default"].createElement("tfoot",null,"function"==typeof m&&m({rows:b,width:B.fields.length+parseInt(p!==_helpers.NOOP)+parseInt(t!==_helpers.NOOP)}),"function"!=typeof m&&m,(n!==_helpers.NOOP||o!==_helpers.NOOP)&&_react["default"].createElement("tr",null,_react["default"].createElement("td",null,"function"==typeof n&&n({onChange:u}),"function"!=typeof n&&n),_react["default"].createElement("td",null,"function"==typeof o&&o({onChange:v}),"function"!=typeof o&&o)))))};Table.pageLimit=_helpers.PageLimit,Table.pages=_helpers.Pages,Table.defaultProps={rows:[],rowIdentifier:function rowIdentifier(a){return a.id},rowRenderer:function rowRenderer(a){var b=a.key,c=a.row,d=a.fields,e=a.dataManipulator,f=a.actions,g=a.isChecked,h=a.onClick,i=a.onToggle;return _react["default"].createElement("tr",{key:b,onClick:h},i&&_react["default"].createElement("td",null,_react["default"].createElement("input",{type:"checkbox",checked:g,onChange:i})),d.map(function(a){return _react["default"].createElement("td",{key:a},e({field:a,value:c[a],row:c}))}),!!f&&_react["default"].createElement("td",null,f))},emptyRow:_react["default"].createElement("tr",null,_react["default"].createElement("td",null,"There's nothing here.")),dataManipulator:function dataManipulator(a){var b=a.value;return null!==b&&b!==void 0?b:"-"},fieldMap:{},fieldOrder:[],fieldsToExclude:[],fieldsToInclude:[],header:!0,footer:_helpers.NOOP,pageLimit:_helpers.NOOP,pages:_helpers.NOOP,actions:_helpers.NOOP,rowIsChecked:_helpers.NOOP,masterIsChecked:_helpers.NOOP,onRowClick:_helpers.NOOP,onRowToggle:_helpers.NOOP,onPageLimitChange:_helpers.NOOP,onPageChange:_helpers.NOOP,onMasterToggle:_helpers.NOOP},Table.propTypes={rows:_propTypes["default"].arrayOf(_propTypes["default"].object),rowIdentifier:_propTypes["default"].func,rowRenderer:_propTypes["default"].func,emptyRow:_propTypes["default"].node,dataManipulator:_propTypes["default"].func,fieldMap:_propTypes["default"].object,fieldOrder:_propTypes["default"].arrayOf(_propTypes["default"].oneOfType([_propTypes["default"].string,_propTypes["default"].instanceOf(RegExp)])),fieldsToExclude:_propTypes["default"].arrayOf(_propTypes["default"].oneOfType([_propTypes["default"].string,_propTypes["default"].instanceOf(RegExp)])),fieldsToInclude:_propTypes["default"].arrayOf(_propTypes["default"].oneOfType([_propTypes["default"].string,_propTypes["default"].instanceOf(RegExp)])),header:_propTypes["default"].bool,footer:_propTypes["default"].oneOfType([_propTypes["default"].node,_propTypes["default"].func]),pageLimit:_propTypes["default"].oneOfType([_propTypes["default"].node,_propTypes["default"].func]),pages:_propTypes["default"].oneOfType([_propTypes["default"].node,_propTypes["default"].func]),actions:_propTypes["default"].func,rowIsChecked:_propTypes["default"].func,masterIsChecked:_propTypes["default"].func,onRowClick:_propTypes["default"].func,onRowToggle:_propTypes["default"].func,onPageLimitChange:_propTypes["default"].func,onPageChange:_propTypes["default"].func,onMasterToggle:_propTypes["default"].func};var _default=Table;exports["default"]=_default;